let currentTab="article";const tabs=["guide","article","questions"];function initMobileTabs(){if(window.innerWidth>900)return;createTabNavigation(),createTabContainer(),setupContentObserver(),setupSwipeGestures(),showSwipeHintOnce();switchTab(localStorage.getItem("lastActiveTab")||"article")}function createTabNavigation(){const e=document.getElementById("user-info-bar");if(!e)return;e.insertAdjacentHTML("afterend",'\n        <div class="mobile-tab-nav">\n            <button class="tab-btn active" data-tab="article" onclick="switchTab(\'article\')">\n                <span class="tab-icon">ğŸ“–</span>\n                <span class="tab-label">é–±è®€æ–‡ç« </span>\n            </button>\n            <button class="tab-btn" data-tab="questions" onclick="switchTab(\'questions\')">\n                <span class="tab-icon">âœï¸</span>\n                <span class="tab-label">ç­”é¡Œ</span>\n                <span class="tab-badge" id="progress-badge">0/0</span>\n            </button>\n            <button class="tab-btn" data-tab="guide" onclick="switchTab(\'guide\')">\n                <span class="tab-icon">ğŸ’¡</span>\n                <span class="tab-label">èªªæ˜</span>\n            </button>\n        </div>\n    ')}function createTabContainer(){const e=document.querySelector(".container");if(!e)return;const t=document.createElement("div");t.className="mobile-tab-container",t.innerHTML='\n        \x3c!-- Tab 1: é–±è®€æ–‡ç«  --\x3e\n        <div class="tab-pane active" id="article-pane">\n            <h1 id="article-title-mobile"></h1>\n            <div id="article-body-mobile"></div>\n        </div>\n        \n        \x3c!-- Tab 2: æ¸¬é©—å•é¡Œ --\x3e\n        <div class="tab-pane" id="questions-pane">\n            <h2>é–±è®€ç†è§£å•é¡Œ</h2>\n            <div id="questions-container-mobile"></div>\n            <button id="submit-btn-mobile" class="submit-button" onclick="submitQuiz()">æäº¤ç­”æ¡ˆ</button>\n        </div>\n        \n        \x3c!-- Tab 3: ä½¿ç”¨èªªæ˜ --\x3e\n        <div class="tab-pane" id="guide-pane">\n            <h2>ä½¿ç”¨æŒ‡å—</h2>\n            <div id="guide-content-mobile"></div>\n        </div>\n    ',e.insertAdjacentElement("afterend",t),copyContentToMobile()}function copyContentToMobile(){const e=document.getElementById("article-title-display"),t=document.getElementById("article-body");e&&t&&(document.getElementById("article-title-mobile").innerHTML=e.innerHTML,document.getElementById("article-body-mobile").innerHTML=t.innerHTML);const n=document.getElementById("questions-container");n&&(document.getElementById("questions-container-mobile").innerHTML=n.innerHTML);const o=document.getElementById("left-column");if(o){const e=o.querySelectorAll(".step"),t=document.getElementById("guide-content-mobile");t.innerHTML="",e.forEach(e=>{t.appendChild(e.cloneNode(!0))})}updateProgressBadge()}function setupContentObserver(){let e=!1;const t=document.getElementById("questions-container");if(t){new MutationObserver(n=>{const o=document.getElementById("questions-container-mobile"),i=(t.querySelector(".skeleton-loader"),t.querySelector(".question"));if(!e&&i&&o){o.querySelector(".question")&&!o.querySelector(".skeleton-loader")||(console.log("[ContentObserver] Initial load detected, copying content..."),o.innerHTML=t.innerHTML,setupMobileRadioListeners(),syncAnswersToMobile(),updateProgressBadge(),e=!0,console.log("[ContentObserver] Content loaded, observer will now ignore changes"))}}).observe(t,{childList:!0,subtree:!0})}const n=document.getElementById("article-body");if(n){new MutationObserver(e=>{const t=document.getElementById("article-body-mobile");t&&n.innerHTML&&(t.innerHTML=n.innerHTML)}).observe(n,{childList:!0,subtree:!0})}const o=document.getElementById("article-title-display");if(o){new MutationObserver(e=>{const t=document.getElementById("article-title-mobile");t&&o.innerHTML&&(t.innerHTML=o.innerHTML)}).observe(o,{childList:!0,subtree:!0,characterData:!0})}}function switchTab(e){document.querySelectorAll(".mobile-tab-nav .tab-btn").forEach(e=>{e.classList.remove("active")});const t=document.querySelector(`.mobile-tab-nav .tab-btn[data-tab="${e}"]`);t&&t.classList.add("active"),document.querySelectorAll(".mobile-tab-container .tab-pane").forEach(e=>{e.classList.remove("active")});const n=document.getElementById(`${e}-pane`);n&&n.classList.add("active"),currentTab=e,localStorage.setItem("lastActiveTab",e),"questions"===e&&syncAnswersToMobile()}function syncAnswersToMobile(){document.querySelectorAll('.container input[type="radio"]:checked').forEach(e=>{const t=document.querySelector(`.mobile-tab-container input[name="${e.name}"][value="${e.value}"]`);t&&(t.checked=!0)}),updateProgressBadge()}function updateProgressBadge(){const e=document.querySelector(".mobile-tab-container");if(!e)return void console.log("[Progress] Mobile container not found");const t=e.querySelectorAll(".question"),n=t.length;if(0===n)return void console.log("[Progress] No questions found");const o=new Set;t.forEach((e,t)=>{e.querySelector('input[type="radio"]:checked')&&o.add(t)});const i=o.size,s=document.getElementById("progress-badge");s&&(s.textContent=`${i}/${n}`,i===n&&n>0?(s.style.background="#ffd700",s.style.color="#333"):(s.style.background="var(--secondary-color)",s.style.color="white"));const a=document.getElementById("submit-btn-mobile");a&&(a.disabled=!1,i===n?(a.classList.add("ready"),a.textContent="âœ… æäº¤ç­”æ¡ˆ"):i>0?(a.classList.remove("ready"),a.textContent=`æäº¤ç­”æ¡ˆ (${i}/${n})`):(a.classList.remove("ready"),a.textContent="æäº¤ç­”æ¡ˆ"))}function setupSwipeGestures(){let e=0,t=0;const n=document.querySelector(".mobile-tab-container");n&&(n.addEventListener("touchstart",t=>{e=t.changedTouches[0].screenX},{passive:!0}),n.addEventListener("touchend",n=>{t=n.changedTouches[0].screenX,function(){const n=e-t;if(Math.abs(n)<75)return;const o=tabs.indexOf(currentTab);n>0&&o<tabs.length-1?switchTab(tabs[o+1]):n<0&&o>0&&switchTab(tabs[o-1])}()},{passive:!0}))}function showSwipeHintOnce(){if(!localStorage.getItem("hasSeenSwipeHint")&&window.innerWidth<=900){const e=document.createElement("div");e.className="swipe-hint",e.innerHTML="ğŸ’¡ æç¤ºï¼šå¯å·¦å³æ»‘å‹•åˆ‡æ› Tab",document.body.appendChild(e),setTimeout(()=>{e.remove(),localStorage.setItem("hasSeenSwipeHint","true")},3500)}}function setupMobileRadioListeners(){}function updateOptionStyles(e){const t=e.closest(".question");if(!t)return;t.querySelectorAll('input[type="radio"]').forEach(e=>{e.checked=!1}),e.checked=!0,t.querySelectorAll(".option").forEach(e=>{e.classList.remove("selected")});const n=e.closest(".option");n&&n.classList.add("selected")}let resizeTimer;document.addEventListener("change",e=>{if("radio"===e.target.type&&e.target.closest(".mobile-tab-container")){updateOptionStyles(e.target),updateProgressBadge()}}),window.addEventListener("DOMContentLoaded",()=>{setTimeout(()=>{initMobileTabs()},500)}),window.addEventListener("resize",()=>{clearTimeout(resizeTimer),resizeTimer=setTimeout(()=>{location.reload()},500)}),window.submitQuiz=function(){document.querySelectorAll('.mobile-tab-container input[type="radio"]:checked').forEach(e=>{const t=document.querySelector('.container input[name="'+e.name+'"][value="'+e.value+'"]');t&&(t.checked=!0)}),"function"==typeof window.checkAnswers&&(window.checkAnswers(),setTimeout(()=>{"function"==typeof window.switchTab&&switchTab("article"),setTimeout(()=>{const e=document.getElementById("current-stats"),t=document.getElementById("article-pane");if(e&&e.innerHTML&&t){let n=t.querySelector("#current-stats-mobile");n||(n=document.createElement("div"),n.id="current-stats-mobile",n.style.cssText=e.style.cssText,t.appendChild(n)),n.innerHTML=e.innerHTML,n.scrollIntoView({behavior:"smooth",block:"start"})}},100)},300))},window.switchTab=switchTab;